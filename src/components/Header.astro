---
import { Image } from 'astro:assets';
import miFoto from '../assets/Imagenes/me.webp';
---

<header class="fixed top-0 left-0 right-0 z-50 backdrop-blur bg-neutral-100/70 dark:bg-neutral-900/70 shadow-sm transition-colors duration-300">
  <div class="max-w-7xl mx-auto px-4 lg:px-8">
    <div class="flex items-center justify-between py-3">
      <Image 
        class="rounded-full w-10 h-10 hidden sm:block object-cover"
        width={800} height={800}
        src={miFoto}
        alt="me"
      />

      <h2 class="sm:hidden font-semibold">
        Portafolio
      </h2>
      <div class="flex flex-row-reverse gap-x-3 items-center">
        <button
          id="boton"
          aria-label="Abrir men√∫"
          aria-expanded="false"
          class="sm:hidden text-2xl transition-transform duration-300"
        >
          ‚ò∞
        </button>
        <nav
          id="headermenu"
          class="
            
            absolute top-full left-0 w-full 
            dark:bg-neutral-900/70 bg-neutral-100/70 sm:bg-transparent dark:sm:bg-transparent
            sm:static sm:w-auto sm:flex
            flex flex-col sm:flex-row
            gap-4 sm:gap-8
            text-center
            text-sm sm:text-base
            py-4 sm:py-0
            opacity-0 sm:opacity-100
            -translate-y-2 sm:translate-y-0
            transition-all duration-300 ease-out
          "
        >
          <a href="#educacion" class="hover:text-cyan-600 transition-colors">Educaci√≥n</a>
          <a href="#habilidades" class="hover:text-cyan-600 transition-colors">Habilidades</a>
          <a href="#contact" class="hover:text-cyan-600 transition-colors">Contacto</a>
        </nav>

          <button id="themeToggle" class="relative size-5 flex flex-col justify-center overflow-hidden transition-colors items-center">
            
            <span class="absolute transition-all duration-500 ease-in-out transform dark:translate-y-10 dark:opacity-0 translate-y-0 opacity-100">  ‚òÄÔ∏è </span>
            
            <span class="absolut transition-all duration-500 ease-in-out transform dark:translate-y-0 dark:opacity-100 -translate-y-10 opacity-0"> üåô </span>
          </button>

      </div>
    </div>
  </div>
</header>

<script>
  const btn = document.getElementById('boton');
  const menu = document.getElementById('headermenu');

  if (btn && menu) {
    btn.addEventListener('click', () => {
      const isOpen = menu.classList.contains('open');

      if (isOpen) {
        menu.classList.add('opacity-0', '-translate-y-2');
        menu.classList.remove('opacity-100', 'translate-y-0', 'open');

        setTimeout(() => menu.classList.add('hidden'), 300);
        btn.textContent = '‚ò∞';
      } else {
        menu.classList.remove('hidden');
        requestAnimationFrame(() => {
          menu.classList.remove('opacity-0', '-translate-y-2');
          menu.classList.add('opacity-100', 'translate-y-0', 'open');
        });
        btn.textContent = '‚úï';
      }

      btn.setAttribute('aria-expanded', String(!isOpen));
    });

    menu.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        menu.classList.add('opacity-0', '-translate-y-2');
        menu.classList.remove('opacity-100', 'translate-y-0', 'open');

        setTimeout(() => menu.classList.add('hidden'), 300);
        btn.textContent = '‚ò∞';
        btn.setAttribute('aria-expanded', 'false');
      });
    });
  }

  const handleToggleClick = () => {
    const element = document.documentElement;
    element.classList.toggle("dark");

    const isDark = element.classList.contains("dark");
    localStorage.setItem("theme", isDark ? "dark" : "light");
  };

  document.getElementById("themeToggle")?.addEventListener("click", handleToggleClick);
</script>